# 5. 安全注意事项

有关本节中使用的术语的讨论，请参阅 [[RFC3552](https://www.rfc-editor.org/rfc/rfc9239#RFC3552)]。本节中的示例以及主机环境与脚本、模块和 [[ECMA-262](https://www.rfc-editor.org/rfc/rfc9239#ECMA-262)] 中扩展交互的讨论是不完整且纯粹是说明性的。

[[ECMA-262](https://www.rfc-editor.org/rfc/rfc9239#ECMA-262)] 中定义的编程语言并非旨在实现计算自给自足；相反，预想的计算环境为程序提供了启用特定功能的设施。此类设施构成未知因素，因此未在本文档中定义。

派生的编程语言允许包含 [[ECMA-262](https://www.rfc-editor.org/rfc/rfc9239#ECMA-262)] 中未描述的附加功能；此类功能构成未知因素，因此本文档未定义。特别是，本文档不讨论为 JavaScript 编程语言定义的 [[ECMA-262](https://www.rfc-editor.org/rfc/rfc9239#ECMA-262)] 扩展。

不受控制地执行脚本可能非常危险。执行脚本的实现必须考虑其应用程序的威胁模型以及它们实现各个功能的模型；特别是，他们必须确保不受信任的内容不会在不受保护的环境中执行。

ECMAScript 中的模块脚本可以请求获取和处理附加脚本；这称为“导入”。支持模块的实现需要以与脚本相同的方式处理导入的源。有关详细信息，请参阅 [[ECMA-262](https://www.rfc-editor.org/rfc/rfc9239#ECMA-262)] 中的“ECMAScript 语言：脚本和模块”部分。此外，可能存在额外的隐私和安全问题，具体取决于获取原始脚本及其导入模块的位置。例如，从 “host-a.example” 获取的脚本可以请求从 “host-b.example” 导入脚本，这可能会将有关执行环境的信息（例如 IP 地址）暴露给 “host-b.example” 。

主机环境设施和派生编程语言的规范应进行安全考虑。如果实现支持此类设施，则适用相应的安全考虑。特别是，如果脚本可以从特定文档格式中引用或包含在特定文档格式中，则适用于嵌入或引用文档格式的相关注意事项。

例如，嵌入在 application/xhtml+xml [[RFC3236](https://www.rfc-editor.org/rfc/rfc9239#RFC3236)] 文档中的脚本可以通过宿主环境启用来操作文档实例，这可能导致远程资源的检索；在这种情况下，有关检索嵌入文档远程资源的安全考虑将适用。

这种情况还可用于通过将信息编码在资源的标识符中，使通常仅可用于脚本的信息也可用于 Web 服务器，这可进一步实现窃听攻击。如上所述，此类设施的实施取决于宿主环境的安全考虑。

[[ECMA-262](https://www.rfc-editor.org/rfc/rfc9239#ECMA-262)] 中定义的编程语言确实包括循环、导致计算复杂操作或消耗大量内存的工具；这包括但不限于允许执行动态生成的源文本的工具（例如 eval() 函数）；此类功能不受控制的执行可能会导致拒绝服务，实现中必须防止这种情况。

通过在 ECMAScript 8 中添加 SharedArrayBuffer 对象，可以实现高分辨率计时器，这可能导致某些类型的计时和边信道攻击（例如， [[SPECTRE](https://www.rfc-editor.org/rfc/rfc9239#SPECTRE)] ）。实现中可以采取措施来减轻这种问题的影响，例如禁用或删除对 SharedArrayBuffer 对象的支持，或者可以采取其他方法来确保此共享内存只能在具有某种形式的相互信任执行上下文之间访问。

主机环境可以提供访问外部输入的设施。将此类输入传递给 eval() 函数或类似语言功能的脚本可能容易受到代码注入攻击。脚本最好能够防止此类攻击。

主机环境可以提供以用户可见的方式输出计算结果的设施。例如，支持图形用户界面的主机环境可以提供使脚本能够向用户呈现某些消息的设施。实现必须采取措施避免混淆此类消息的来源。通常，主机环境的安全考虑适用于上述情况。

实现需要支持 UTF-8 字符编码方案； [[RFC3629](https://www.rfc-editor.org/rfc/rfc9239#RFC3629)] 的安全考虑适用。可能支持其他字符编码方案；对此类计划的支持取决于这些计划的安全考虑。

源文本应采用 Unicode 规范化形式 C 。脚本和实现必须考虑非规范化源文本和数据的安全隐患。有关此类含义的详细讨论，请参阅 [[RFC3629](https://www.rfc-editor.org/rfc/rfc9239#RFC3629)] 中的安全注意事项。

脚本可以在容易受到代码注入攻击的环境中执行。例如，响应用户输入的通用网关接口 (CGI) 脚本 [[RFC3875](https://www.rfc-editor.org/rfc/rfc9239#RFC3875)] 可以允许能在其他受信任的环境中执行的不受信任的脚本。此威胁场景受制于本文档范围之外的安全注意事项。

“数据”资源标识符方案 [[RFC2397](https://www.rfc-editor.org/rfc/rfc9239#RFC2397)] 与本文档中定义的类型相结合，可用于在其他受信任的内容中包含不受信任的资源标识符时来执行不受信任的脚本。 [[RFC2397](https://www.rfc-editor.org/rfc/rfc9239#RFC2397)] 的安全考虑适用。

实现可能无法实现特定的安全模型或其他方法来防止可能的危险操作。这种故障可能会被利用来获得对系统敏感信息的未经授权访问；此类故障构成未知因素，因此未在本文档中定义。

## Links

* [目录](../SUMMARY.md)
* 上一节 [4.3. 字符编码方案错误处理](../Section4/4.3.md)
* 下一节 [6. IANA 注意事项](../Section6/6.md)