# 4.2 字符编码方案检测

此实现可能无法简单地通过遵守适用规范的所有要求来互操作地确定单个字符编码方案。为了在这种情况下增强互操作性，定义了以下算法。该实现将会应用此算法，直到确定单个字符编码方案。

步骤1：如果二进制源文本尚未确定模块目标并且以 Unicode 编码的形式签名开始，则签名确定编码。在二进制源文本最开头的以下八位字节序列与它们相应的字符编码方案一起考虑：

| 前导序列     | 编码       |
|----------|----------|
| EF BB BF | UTF-8    |
| FF FE    | UTF-16LE |
| FE FF    | UTF-16BE |

此步骤的实现必须使用这些八位字节序列来确定字符编码方案，即使所确定的方案不受支持。如果此步骤确定了字符编码方案，则在解码二进制源文本时必须忽略表示 Unicode 编码形式签名的八位字节序列。

步骤2：接着，如果指定了 charset 参数并且其值有效还实现支持，则该值将确定字符编码方案。

步骤3：最后，还会假定字符编码方案为 UTF-8。

如果通过上述步骤 1 以外的任何方式确定字符编码方案为 UTF-8，并且二进制源文本以八位字节序列 EF BB BF 开头，则在解码二进制源文本时忽略八位字节序列。

## Links

* [目录](../SUMMARY.md)
* 上一节 [4.1 字符集参数](../Section4/4.1.md)
* 下一节 [4.3 字符编码方案错误处理](../Section4/4.3.md)